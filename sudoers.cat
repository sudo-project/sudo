


SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


NNAAMMEE
       sudoers - list of which users may execute what

DDEESSCCRRIIPPTTIIOONN
       The _s_u_d_o_e_r_s file is composed of two types of entries:
       aliases (basically variables) and user specifications
       (which specify who may run what).

       When multiple entries match for a user, they are applied
       in order.  Where there are conflicting values, the last
       match is used (which is not necessarily the most specific
       match).

       The _s_u_d_o_e_r_s grammar will be described below in Extended
       Backus-Naur Form (EBNF).  Don't despair if you don't know
       what EBNF is; it is fairly simple, and the definitions
       below are annotated.

       QQuuiicckk gguuiiddee ttoo EEBBNNFF

       EBNF is a concise and exact way of describing the grammar
       of a language.  Each EBNF definition is made up of _p_r_o_d_u_c_­
       _t_i_o_n _r_u_l_e_s.  E.g.,

        symbol ::= definition | alternate1 | alternate2 ...

       Each _p_r_o_d_u_c_t_i_o_n _r_u_l_e references others and thus makes up a
       grammar for the language.  EBNF also contains the follow­
       ing operators, which many readers will recognize from reg­
       ular expressions.  Do not, however, confuse them with
       "wildcard" characters, which have different meanings.

       ?       Means that the preceding symbol (or group of sym­
               bols) is optional.  That is, it may appear once or
               not at all.

       *       Means that the preceding symbol (or group of sym­
               bols) may appear zero or more times.

       +       Means that the preceding symbol (or group of sym­
               bols) may appear one or more times.

       Parentheses may be used to group symbols together.  For
       clarity, we will use single quotes ('') to designate what
       is a verbatim character string (as opposed to a symbol
       name).

       AAlliiaasseess

       There are four kinds of aliases: User_Alias, Runas_Alias,
       Host_Alias and Cmnd_Alias.






1.6.9                    October  4, 2004                       1





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


        Alias ::= 'User_Alias'  User_Alias (':' User_Alias)* |
                  'Runas_Alias' Runas_Alias (':' Runas_Alias)* |
                  'Host_Alias'  Host_Alias (':' Host_Alias)* |
                  'Cmnd_Alias'  Cmnd_Alias (':' Cmnd_Alias)*

        User_Alias ::= NAME '=' User_List

        Runas_Alias ::= NAME '=' Runas_List

        Host_Alias ::= NAME '=' Host_List

        Cmnd_Alias ::= NAME '=' Cmnd_List

        NAME ::= [A-Z]([A-Z][0-9]_)*

       Each _a_l_i_a_s definition is of the form

        Alias_Type NAME = item1, item2, ...

       where _A_l_i_a_s___T_y_p_e is one of User_Alias, Runas_Alias,
       Host_Alias, or Cmnd_Alias.  A NAME is a string of upper­
       case letters, numbers, and underscore characters ('_').  A
       NAME mmuusstt start with an uppercase letter.  It is possible
       to put several alias definitions of the same type on a
       single line, joined by a colon (':').  E.g.,

        Alias_Type NAME = item1, item2, item3 : NAME = item4, item5

       The definitions of what constitutes a valid _a_l_i_a_s member
       follow.

        User_List ::= User |
                      User ',' User_List

        User ::= '!'* username |
                 '!'* '%'group |
                 '!'* '+'netgroup |
                 '!'* User_Alias

       A User_List is made up of one or more usernames, system
       groups (prefixed with '%'), netgroups (prefixed with '+')
       and other aliases.  Each list item may be prefixed with
       one or more '!' operators.  An odd number of '!' operators
       negate the value of the item; an even number just cancel
       each other out.

        Runas_List ::= Runas_User |
                       Runas_User ',' Runas_List

        Runas_User ::= '!'* username |
                       '!'* '#'uid |
                       '!'* '%'group |
                       '!'* +netgroup |
                       '!'* Runas_Alias



1.6.9                    October  4, 2004                       2





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


       A Runas_List is similar to a User_List except that it can
       also contain uids (prefixed with '#') and instead of
       User_Aliases it can contain Runas_Aliases.  Note that
       usernames and groups are matched as strings.  In other
       words, two users (groups) with the same uid (gid) are con­
       sidered to be distinct.  If you wish to match all user­
       names with the same uid (e.g. root and toor), you can use
       a uid instead (#0 in the example given).

        Host_List ::= Host |
                      Host ',' Host_List

        Host ::= '!'* hostname |
                 '!'* ip_addr |
                 '!'* network(/netmask)? |
                 '!'* '+'netgroup |
                 '!'* Host_Alias

       A Host_List is made up of one or more hostnames, IP
       addresses, network numbers, netgroups (prefixed with '+')
       and other aliases.  Again, the value of an item may be
       negated with the '!' operator.  If you do not specify a
       netmask with a network number, the netmask of the host's
       ethernet interface(s) will be used when matching.  The
       netmask may be specified either in dotted quad notation
       (e.g.  255.255.255.0) or CIDR notation (number of bits,
       e.g. 24).  A hostname may include shell-style wildcards
       (see the Wildcards section below), but unless the hostname
       command on your machine returns the fully qualified host­
       name, you'll need to use the _f_q_d_n option for wildcards to
       be useful.

        Cmnd_List ::= Cmnd |
                      Cmnd ',' Cmnd_List

        commandname ::= filename |
                        filename args |
                        filename '""'

        Cmnd ::= '!'* commandname |
                 '!'* directory |
                 '!'* "sudoedit" |
                 '!'* Cmnd_Alias

       A Cmnd_List is a list of one or more commandnames, direc­
       tories, and other aliases.  A commandname is a fully qual­
       ified filename which may include shell-style wildcards
       (see the Wildcards section below).  A simple filename
       allows the user to run the command with any arguments
       he/she wishes.  However, you may also specify command line
       arguments (including wildcards).  Alternately, you can
       specify "" to indicate that the command may only be run
       wwiitthhoouutt command line arguments.  A directory is a fully
       qualified pathname ending in a '/'.  When you specify a



1.6.9                    October  4, 2004                       3





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


       directory in a Cmnd_List, the user will be able to run any
       file within that directory (but not in any subdirectories
       therein).

       If a Cmnd has associated command line arguments, then the
       arguments in the Cmnd must match exactly those given by
       the user on the command line (or match the wildcards if
       there are any).  Note that the following characters must
       be escaped with a '\' if they are used in command argu­
       ments: ',', ':', '=', '\'.  The special command "sudoedit"
       is used to permit a user to run ssuuddoo with the --ee flag (or
       as ssuuddooeeddiitt).  It may take command line arguments just as
       a normal command does.

       DDeeffaauullttss

       Certain configuration options may be changed from their
       default values at runtime via one or more Default_Entry
       lines.  These may affect all users on any host, all users
       on a specific host, a specific user, or commands being run
       as a specific user.

        Default_Type ::= 'Defaults' |
                         'Defaults' '@' Host |
                         'Defaults' ':' User |
                         'Defaults' '>' RunasUser

        Default_Entry ::= Default_Type Parameter_List

        Parameter_List ::= Parameter |
                           Parameter ',' Parameter_List

        Parameter ::= Parameter '=' Value |
                      Parameter '+=' Value |
                      Parameter '-=' Value |
                      '!'* Parameter

       Parameters may be ffllaaggss, iinntteeggeerr values, ssttrriinnggss, or
       lliissttss.  Flags are implicitly boolean and can be turned off
       via the '!'  operator.  Some integer, string and list
       parameters may also be used in a boolean context to dis­
       able them.  Values may be enclosed in double quotes (")
       when they contain multiple words.  Special characters may
       be escaped with a backslash (\).

       Lists have two additional assignment operators, += and -=.
       These operators are used to add to and delete from a list
       respectively.  It is not an error to use the -= operator
       to remove an element that does not exist in a list.

       FFllaaggss:

       long_otp_prompt
                   When validating with a One Time Password



1.6.9                    October  4, 2004                       4





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


                   scheme (SS//KKeeyy or OOPPIIEE), a two-line prompt is
                   used to make it easier to cut and paste the
                   challenge to a local window.  It's not as
                   pretty as the default but some people find it
                   more convenient.  This flag is _o_f_f by default.

       ignore_dot  If set, ssuuddoo will ignore '.' or '' (current
                   dir) in the PATH environment variable; the
                   PATH itself is not modified.  This flag is _o_f_f
                   by default.  Currently, while it is possible
                   to set _i_g_n_o_r_e___d_o_t in _s_u_d_o_e_r_s, its value is not
                   used.  This option should be considered read-
                   only (it will be fixed in a future version of
                   ssuuddoo).

       mail_always Send mail to the _m_a_i_l_t_o user every time a
                   users runs ssuuddoo.  This flag is _o_f_f by default.

       mail_badpass
                   Send mail to the _m_a_i_l_t_o user if the user run­
                   ning ssuuddoo does not enter the correct password.
                   This flag is _o_f_f by default.

       mail_no_user
                   If set, mail will be sent to the _m_a_i_l_t_o user
                   if the invoking user is not in the _s_u_d_o_e_r_s
                   file.  This flag is _o_n by default.

       mail_no_host
                   If set, mail will be sent to the _m_a_i_l_t_o user
                   if the invoking user exists in the _s_u_d_o_e_r_s
                   file, but is not allowed to run commands on
                   the current host.  This flag is _o_f_f by
                   default.

       mail_no_perms
                   If set, mail will be sent to the _m_a_i_l_t_o user
                   if the invoking user is allowed to use ssuuddoo
                   but the command they are trying is not listed
                   in their _s_u_d_o_e_r_s file entry or is explicitly
                   denied.  This flag is _o_f_f by default.

       tty_tickets If set, users must authenticate on a per-tty
                   basis.  Normally, ssuuddoo uses a directory in the
                   ticket dir with the same name as the user run­
                   ning it.  With this flag enabled, ssuuddoo will
                   use a file named for the tty the user is
                   logged in on in that directory.  This flag is
                   _o_f_f by default.

       authenticate
                   If set, users must authenticate themselves via
                   a password (or other means of authentication)
                   before they may run commands.  This default



1.6.9                    October  4, 2004                       5





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


                   may be overridden via the PASSWD and NOPASSWD
                   tags.  This flag is _o_n by default.

       root_sudo   If set, root is allowed to run ssuuddoo too.  Dis­
                   abling this prevents users from "chaining"
                   ssuuddoo commands to get a root shell by doing
                   something like "sudo sudo /bin/sh".  Note,
                   however, that turning off _r_o_o_t___s_u_d_o will also
                   prevent root and from running ssuuddooeeddiitt.  Dis­
                   abling _r_o_o_t___s_u_d_o provides no real additional
                   security; it exists purely for historical rea­
                   sons.  This flag is _o_n by default.

       log_host    If set, the hostname will be logged in the
                   (non-syslog) ssuuddoo log file.  This flag is _o_f_f
                   by default.

       log_year    If set, the four-digit year will be logged in
                   the (non-syslog) ssuuddoo log file.  This flag is
                   _o_f_f by default.

       shell_noargs
                   If set and ssuuddoo is invoked with no arguments
                   it acts as if the --ss flag had been given.
                   That is, it runs a shell as root (the shell is
                   determined by the SHELL environment variable
                   if it is set, falling back on the shell listed
                   in the invoking user's /etc/passwd entry if
                   not).  This flag is _o_f_f by default.

       set_home    If set and ssuuddoo is invoked with the --ss flag
                   the HOME environment variable will be set to
                   the home directory of the target user (which
                   is root unless the --uu option is used).  This
                   effectively makes the --ss flag imply --HH.  This
                   flag is _o_f_f by default.

       always_set_home
                   If set, ssuuddoo will set the HOME environment
                   variable to the home directory of the target
                   user (which is root unless the --uu option is
                   used).  This effectively means that the --HH
                   flag is always implied.  This flag is _o_f_f by
                   default.

       path_info   Normally, ssuuddoo will tell the user when a com­
                   mand could not be found in their PATH environ­
                   ment variable.  Some sites may wish to disable
                   this as it could be used to gather information
                   on the location of executables that the normal
                   user does not have access to.  The disadvan­
                   tage is that if the executable is simply not
                   in the user's PATH, ssuuddoo will tell the user
                   that they are not allowed to run it, which can



1.6.9                    October  4, 2004                       6





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


                   be confusing.  This flag is _o_f_f by default.

       preserve_groups
                   By default ssuuddoo will initialize the group vec­
                   tor to the list of groups the target user is
                   in.  When _p_r_e_s_e_r_v_e___g_r_o_u_p_s is set, the user's
                   existing group vector is left unaltered.  The
                   real and effective group IDs, however, are
                   still set to match the target user.  This flag
                   is _o_f_f by default.

       fqdn        Set this flag if you want to put fully quali­
                   fied hostnames in the _s_u_d_o_e_r_s file.  I.e.,
                   instead of myhost you would use myhost.mydo­
                   main.edu.  You may still use the short form if
                   you wish (and even mix the two).  Beware that
                   turning on _f_q_d_n requires ssuuddoo to make DNS
                   lookups which may make ssuuddoo unusable if DNS
                   stops working (for example if the machine is
                   not plugged into the network).  Also note that
                   you must use the host's official name as DNS
                   knows it.  That is, you may not use a host
                   alias (CNAME entry) due to performance issues
                   and the fact that there is no way to get all
                   aliases from DNS.  If your machine's hostname
                   (as returned by the hostname command) is
                   already fully qualified you shouldn't need to
                   set _f_q_d_n.  This flag is _o_f_f by default.

       insults     If set, ssuuddoo will insult users when they enter
                   an incorrect password.  This flag is _o_f_f by
                   default.

       requiretty  If set, ssuuddoo will only run when the user is
                   logged in to a real tty.  This will disallow
                   things like "rsh somehost sudo ls" since
                   _r_s_h(1) does not allocate a tty.  Because it is
                   not possible to turn off echo when there is no
                   tty present, some sites may with to set this
                   flag to prevent a user from entering a visible
                   password.  This flag is _o_f_f by default.

       env_editor  If set, vviissuuddoo will use the value of the EDI­
                   TOR or VISUAL environment variables before
                   falling back on the default editor list.  Note
                   that this may create a security hole as it
                   allows the user to run any arbitrary command
                   as root without logging.  A safer alternative
                   is to place a colon-separated list of editors
                   in the editor variable.  vviissuuddoo will then only
                   use the EDITOR or VISUAL if they match a value
                   specified in editor.  This flag is off by
                   default.




1.6.9                    October  4, 2004                       7





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


       rootpw      If set, ssuuddoo will prompt for the root password
                   instead of the password of the invoking user.
                   This flag is _o_f_f by default.

       runaspw     If set, ssuuddoo will prompt for the password of
                   the user defined by the _r_u_n_a_s___d_e_f_a_u_l_t option
                   (defaults to root) instead of the password of
                   the invoking user.  This flag is _o_f_f by
                   default.

       targetpw    If set, ssuuddoo will prompt for the password of
                   the user specified by the --uu flag (defaults to
                   root) instead of the password of the invoking
                   user.  Note that this precludes the use of a
                   uid not listed in the passwd database as an
                   argument to the --uu flag.  This flag is _o_f_f by
                   default.

       set_logname Normally, ssuuddoo will set the LOGNAME and USER
                   environment variables to the name of the tar­
                   get user (usually root unless the --uu flag is
                   given).  However, since some programs (includ­
                   ing the RCS revision control system) use LOG­
                   NAME to determine the real identity of the
                   user, it may be desirable to change this
                   behavior.  This can be done by negating the
                   set_logname option.

       stay_setuid Normally, when ssuuddoo executes a command the
                   real and effective UIDs are set to the target
                   user (root by default).  This option changes
                   that behavior such that the real UID is left
                   as the invoking user's UID.  In other words,
                   this makes ssuuddoo act as a setuid wrapper.  This
                   can be useful on systems that disable some
                   potentially dangerous functionality when a
                   program is run setuid.  Note, however, that
                   this means that ssuuddoo will run with the real
                   uid of the invoking user which may allow that
                   user to kill ssuuddoo before it can log a failure,
                   depending on how your OS defines the interac­
                   tion between signals and setuid processes.

       env_reset   If set, ssuuddoo will reset the environment to
                   only contain the following variables: HOME,
                   LOGNAME, PATH, SHELL, TERM, and USER (in addi­
                   tion to the SUDO_* variables).  Of these, only
                   TERM is copied unaltered from the old environ­
                   ment.  The other variables are set to default
                   values (possibly modified by the value of the
                   _s_e_t___l_o_g_n_a_m_e option).  If ssuuddoo was compiled
                   with the SECURE_PATH option, its value will be
                   used for the PATH environment variable.  Other
                   variables may be preserved with the _e_n_v___k_e_e_p



1.6.9                    October  4, 2004                       8





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


                   option.

       use_loginclass
                   If set, ssuuddoo will apply the defaults specified
                   for the target user's login class if one
                   exists.  Only available if ssuuddoo is configured
                   with the --with-logincap option.  This flag is
                   _o_f_f by default.

       noexec      If set, all commands run via ssuuddoo will behave
                   as if the NOEXEC tag has been set, unless
                   overridden by a EXEC tag.  See the description
                   of _N_O_E_X_E_C _a_n_d _E_X_E_C below as well as the "PRE­
                   VENTING SHELL ESCAPES" section at the end of
                   this manual.  This flag is _o_f_f by default.

       monitor     If set, all commands run via ssuuddoo will behave
                   as if the MONITOR tag has been set, unless
                   overridden by a NOMONITOR tag.  See the
                   description of _M_O_N_I_T_O_R _a_n_d _N_O_M_O_N_I_T_O_R below as
                   well as the "PREVENTING SHELL ESCAPES" section
                   at the end of this manual.  Be aware that
                   tracing is only supported on certain operating
                   systems.  On systems where it is not supported
                   this flag will have no effect.  This flag is
                   _o_f_f by default.

       ignore_local_sudoers
                   If set via LDAP, parsing of @sysconfdir@/sudo­
                   ers will be skipped.  This is intended for an
                   Enterprises that wish to prevent the usage of
                   local sudoers files so that only LDAP is used.
                   This thwarts the efforts of rogue operators
                   who would attempt to add roles to
                   @sysconfdir@/sudoers.  When this option is
                   present, @sysconfdir@/sudoers does not even
                   need to exist.  Since this options tells ssuuddoo
                   how to behave when no specific LDAP entries
                   have been matched, this sudoOption is only
                   meaningful for the cn=defaults section.  This
                   flag is _o_f_f by default.

       IInntteeggeerrss:

       passwd_tries
                   The number of tries a user gets to enter
                   his/her password before ssuuddoo logs the failure
                   and exits.  The default is 3.

       IInntteeggeerrss tthhaatt ccaann bbee uusseedd iinn aa bboooolleeaann ccoonntteexxtt:

       loglinelen  Number of characters per line for the file
                   log.  This value is used to decide when to
                   wrap lines for nicer log files.  This has no



1.6.9                    October  4, 2004                       9





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


                   effect on the syslog log file, only the file
                   log.  The default is 80 (use 0 or negate the
                   option to disable word wrap).

       timestamp_timeout
                   Number of minutes that can elapse before ssuuddoo
                   will ask for a passwd again.  The default is
                   5.  Set this to 0 to always prompt for a pass­
                   word.  If set to a value less than 0 the
                   user's timestamp will never expire.  This can
                   be used to allow users to create or delete
                   their own timestamps via sudo -v and sudo -k
                   respectively.

       passwd_timeout
                   Number of minutes before the ssuuddoo password
                   prompt times out.  The default is 5, set this
                   to 0 for no password timeout.

       umask       Umask to use when running the command.  Negate
                   this option or set it to 0777 to preserve the
                   user's umask.  The default is 0022.

       SSttrriinnggss:

       mailsub     Subject of the mail sent to the _m_a_i_l_t_o user.
                   The escape %h will expand to the hostname of
                   the machine.  Default is *** SECURITY informa­
                   tion for %h ***.

       badpass_message
                   Message that is displayed if a user enters an
                   incorrect password.  The default is Sorry, try
                   again. unless insults are enabled.

       timestampdir
                   The directory in which ssuuddoo stores its times­
                   tamp files.  The default is _/_v_a_r_/_r_u_n_/_s_u_d_o.

       timestampowner
                   The owner of the timestamp directory and the
                   timestamps stored therein.  The default is
                   root.

       passprompt  The default prompt to use when asking for a
                   password; can be overridden via the --pp option
                   or the SUDO_PROMPT environment variable.  The
                   following percent (`%') escapes are supported:

                   %u      expanded to the invoking user's login
                           name

                   %U      expanded to the login name of the user
                           the command will be run as (defaults



1.6.9                    October  4, 2004                      10





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


                           to root)

                   %h      expanded to the local hostname without
                           the domain name

                   %H      expanded to the local hostname includ­
                           ing the domain name (on if the
                           machine's hostname is fully qualified
                           or the _f_q_d_n option is set)

                   %%      two consecutive % characters are col­
                           laped into a single % character

                   The default value is Password:.

       runas_default
                   The default user to run commands as if the --uu
                   flag is not specified on the command line.
                   This defaults to root.  Note that if
                   _r_u_n_a_s___d_e_f_a_u_l_t is set it mmuusstt occur before any
                   Runas_Alias specifications.

       syslog_goodpri
                   Syslog priority to use when user authenticates
                   successfully.  Defaults to notice.

       syslog_badpri
                   Syslog priority to use when user authenticates
                   unsuccessfully.  Defaults to alert.

       editor      A colon (':') separated list of editors
                   allowed to be used with vviissuuddoo.  vviissuuddoo will
                   choose the editor that matches the user's USER
                   environment variable if possible, or the first
                   editor in the list that exists and is exe­
                   cutable.  The default is the path to vi on
                   your system.

       noexec_file Path to a shared library containing dummy ver­
                   sions of the _e_x_e_c_v_(_), _e_x_e_c_v_e_(_) and _f_e_x_e_c_v_e_(_)
                   library functions that just return an error.
                   This is used to implement the _n_o_e_x_e_c function­
                   ality on systems that support LD_PRELOAD or
                   its equivalent.  Defaults to
                   _/_u_s_r_/_l_o_c_a_l_/_l_i_b_e_x_e_c_/_s_u_d_o___n_o_e_x_e_c_._s_o.

       SSttrriinnggss tthhaatt ccaann bbee uusseedd iinn aa bboooolleeaann ccoonntteexxtt:

       lecture     This option controls when a short lecture will
                   be printed along with the password prompt.  It
                   has the following possible values:

                   never   Never lecture the user.




1.6.9                    October  4, 2004                      11





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


                   once    Only lecture the user the first time
                           they run ssuuddoo.

                   always  Always lecture the user.

                   The default value is _o_n_c_e.

       lecture_file
                   Path to a file containing an alternate ssuuddoo
                   lecture that will be used in place of the
                   standard lecture if the named file exists.

       logfile     Path to the ssuuddoo log file (not the syslog log
                   file).  Setting a path turns on logging to a
                   file; negating this option turns it off.

       syslog      Syslog facility if syslog is being used for
                   logging (negate to disable syslog logging).
                   Defaults to local2.

       mailerpath  Path to mail program used to send warning
                   mail.  Defaults to the path to sendmail found
                   at configure time.

       mailerflags Flags to use when invoking mailer. Defaults to
                   --tt.

       mailto      Address to send warning and error mail to.
                   The address should be enclosed in double
                   quotes (") to protect against ssuuddoo interpret­
                   ing the @ sign.  Defaults to root.

       exempt_group
                   Users in this group are exempt from password
                   and PATH requirements.  This is not set by
                   default.

       verifypw    This option controls when a password will be
                   required when a user runs ssuuddoo with the --vv
                   flag.  It has the following possible values:

                   all     All the user's _s_u_d_o_e_r_s entries for the
                           current host must have the NOPASSWD
                           flag set to avoid entering a password.

                   any     At least one of the user's _s_u_d_o_e_r_s
                           entries for the current host must have
                           the NOPASSWD flag set to avoid enter­
                           ing a password.

                   never   The user need never enter a password
                           to use the --vv flag.

                   always  The user must always enter a password



1.6.9                    October  4, 2004                      12





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


                           to use the --vv flag.

                   The default value is `all'.

       listpw      This option controls when a password will be
                   required when a user runs ssuuddoo with the --ll
                   flag.  It has the following possible values:

                   all     All the user's _s_u_d_o_e_r_s entries for the
                           current host must have the NOPASSWD
                           flag set to avoid entering a password.

                   any     At least one of the user's _s_u_d_o_e_r_s
                           entries for the current host must have
                           the NOPASSWD flag set to avoid enter­
                           ing a password.

                   never   The user need never enter a password
                           to use the --ll flag.

                   always  The user must always enter a password
                           to use the --ll flag.

                   The default value is `any'.

       LLiissttss tthhaatt ccaann bbee uusseedd iinn aa bboooolleeaann ccoonntteexxtt:

       env_check   Environment variables to be removed from the
                   user's environment if the variable's value
                   contains % or / characters.  This can be used
                   to guard against printf-style format vulnera­
                   bilities in poorly-written programs.  The
                   argument may be a double-quoted, space-sepa­
                   rated list or a single value without dou­
                   ble-quotes.  The list can be replaced, added
                   to, deleted from, or disabled by using the =,
                   +=, -=, and ! operators respectively.  The
                   default list of environment variables to check
                   is printed when ssuuddoo is run by root with the
                   _-_V option.

       env_delete  Environment variables to be removed from the
                   user's environment.  The argument may be a
                   double-quoted, space-separated list or a sin­
                   gle value without double-quotes.  The list can
                   be replaced, added to, deleted from, or dis­
                   abled by using the =, +=, -=, and ! operators
                   respectively.  The default list of environment
                   variables to remove is printed when ssuuddoo is
                   run by root with the _-_V option.  Note that
                   many operating systems will remove potentially
                   dangerous variables from the environment of
                   any setuid process (such as ssuuddoo).




1.6.9                    October  4, 2004                      13





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


       env_keep    Environment variables to be preserved in the
                   user's environment when the _e_n_v___r_e_s_e_t option
                   is in effect.  This allows fine-grained con­
                   trol over the environment ssuuddoo-spawned pro­
                   cesses will receive.  The argument may be a
                   double-quoted, space-separated list or a sin­
                   gle value without double-quotes.  The list can
                   be replaced, added to, deleted from, or dis­
                   abled by using the =, +=, -=, and ! operators
                   respectively.  This list has no default mem­
                   bers.

       When logging via _s_y_s_l_o_g(3), ssuuddoo accepts the following
       values for the syslog facility (the value of the ssyysslloogg
       Parameter): aauutthhpprriivv (if your OS supports it), aauutthh, ddaaee­­
       mmoonn, uusseerr, llooccaall00, llooccaall11, llooccaall22, llooccaall33, llooccaall44, llooccaall55,
       llooccaall66, and llooccaall77.  The following syslog priorities are
       supported: aalleerrtt, ccrriitt, ddeebbuugg, eemmeerrgg, eerrrr, iinnffoo, nnoottiiccee,
       and wwaarrnniinngg.

       UUsseerr SSppeecciiffiiccaattiioonn

        User_Spec ::= User_List Host_List '=' Cmnd_Spec_List \
                      (':' Host_List '=' Cmnd_Spec_List)*

        Cmnd_Spec_List ::= Cmnd_Spec |
                           Cmnd_Spec ',' Cmnd_Spec_List

        Cmnd_Spec ::= Runas_Spec? Tag_Spec* Cmnd

        Runas_Spec ::= '(' Runas_List ')'

        Tag_Spec ::= ('NOPASSWD:' | 'PASSWD:' | 'NOEXEC:' | 'EXEC:' |
                      'MONITOR' | 'NOMONITOR')

       A uusseerr ssppeecciiffiiccaattiioonn determines which commands a user may
       run (and as what user) on specified hosts.  By default,
       commands are run as rroooott, but this can be changed on a
       per-command basis.

       Let's break that down into its constituent parts:

       RRuunnaass__SSppeecc

       A Runas_Spec is simply a Runas_List (as defined above)
       enclosed in a set of parentheses.  If you do not specify a
       Runas_Spec in the user specification, a default Runas_Spec
       of rroooott will be used.  A Runas_Spec sets the default for
       commands that follow it.  What this means is that for the
       entry:

        dgb    boulder = (operator) /bin/ls, /bin/kill, /usr/bin/lprm

       The user ddggbb may run _/_b_i_n_/_l_s, _/_b_i_n_/_k_i_l_l, and _/_u_s_r_/_b_i_n_/_l_p_r_m



1.6.9                    October  4, 2004                      14





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


       -- but only as ooppeerraattoorr.  E.g.,

        $ sudo -u operator /bin/ls.

       It is also possible to override a Runas_Spec later on in
       an entry.  If we modify the entry like so:

        dgb    boulder = (operator) /bin/ls, (root) /bin/kill, /usr/bin/lprm

       Then user ddggbb is now allowed to run _/_b_i_n_/_l_s as ooppeerraattoorr,
       but  _/_b_i_n_/_k_i_l_l and _/_u_s_r_/_b_i_n_/_l_p_r_m as rroooott.

       TTaagg__SSppeecc

       A command may have zero or more tags associated with it.
       There are four possible tag values, NOPASSWD, PASSWD,
       NOEXEC, EXEC, MONITOR and NOMONITOR.  Once a tag is set on
       a Cmnd, subsequent Cmnds in the Cmnd_Spec_List, inherit
       the tag unless it is overridden by the opposite tag (ie:
       PASSWD overrides NOPASSWD and NOMONITOR overrides MONI­
       TOR).

       _N_O_P_A_S_S_W_D _a_n_d _P_A_S_S_W_D

       By default, ssuuddoo requires that a user authenticate him or
       herself before running a command.  This behavior can be
       modified via the NOPASSWD tag.  Like a Runas_Spec, the
       NOPASSWD tag sets a default for the commands that follow
       it in the Cmnd_Spec_List.  Conversely, the PASSWD tag can
       be used to reverse things.  For example:

        ray    rushmore = NOPASSWD: /bin/kill, /bin/ls, /usr/bin/lprm

       would allow the user rraayy to run _/_b_i_n_/_k_i_l_l, _/_b_i_n_/_l_s, and
       _/_u_s_r_/_b_i_n_/_l_p_r_m as root on the machine rushmore as rroooott
       without authenticating himself.  If we only want rraayy to be
       able to run _/_b_i_n_/_k_i_l_l without a password the entry would
       be:

        ray    rushmore = NOPASSWD: /bin/kill, PASSWD: /bin/ls, /usr/bin/lprm

       Note, however, that the PASSWD tag has no effect on users
       who are in the group specified by the exempt_group option.

       By default, if the NOPASSWD tag is applied to any of the
       entries for a user on the current host, he or she will be
       able to run sudo -l without a password.  Additionally, a
       user may only run sudo -v without a password if the
       NOPASSWD tag is present for all a user's entries that per­
       tain to the current host.  This behavior may be overridden
       via the verifypw and listpw options.

       _N_O_E_X_E_C _a_n_d _E_X_E_C




1.6.9                    October  4, 2004                      15





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


       If ssuuddoo has been compiled with _n_o_e_x_e_c support and the
       underlying operating system supports it, the NOEXEC tag
       can be used to prevent a dynamically-linked executable
       from running further commands itself.

       In the following example, user aaaarroonn may run _/_u_s_r_/_b_i_n_/_m_o_r_e
       and _/_u_s_r_/_b_i_n_/_v_i but shell escapes will be disabled.

        aaron  shanty = NOEXEC: /usr/bin/more, /usr/bin/vi

       See the "PREVENTING SHELL ESCAPES" section below for more
       details on how NOEXEC works and whether or not it will
       work on your system.

       _M_O_N_I_T_O_R _a_n_d _N_O_M_O_N_I_T_O_R

       If ssuuddoo has been configured with the --with-systrace
       option, the MONITOR tag can be used to cause programs
       spawned by a command to be checked against _s_u_d_o_e_r_s and
       logged just like they would be if run through ssuuddoo
       directly.  This is useful in conjunction with commands
       that allow shell escapes such as editors, shells and pagi­
       nators.

       In the following example, user cchhuucckk may run any command
       on the machine research in monitor mode.

        chuck  research = MONITOR: ALL

       See the "PREVENTING SHELL ESCAPES" section below for more
       details on how MONITOR works and whether or not it will
       work on your system.

       WWiillddccaarrddss

       ssuuddoo allows shell-style _w_i_l_d_c_a_r_d_s (aka meta or glob char­
       acters) to be used in pathnames as well as command line
       arguments in the _s_u_d_o_e_r_s file.  Wildcard matching is done
       via the PPOOSSIIXX _f_n_m_a_t_c_h(3) routine.  Note that these are _n_o_t
       regular expressions.

       *       Matches any set of zero or more characters.

       ?       Matches any single character.

       [...]   Matches any character in the specified range.

       [!...]  Matches any character nnoott in the specified range.

       \x      For any character "x", evaluates to "x".  This is
               used to escape special characters such as: "*",
               "?", "[", and "}".

       Note that a forward slash ('/') will nnoott be matched by



1.6.9                    October  4, 2004                      16





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


       wildcards used in the pathname.  When matching the command
       line arguments, however, a slash ddooeess get matched by wild­
       cards.  This is to make a path like:

           /usr/bin/*

       match _/_u_s_r_/_b_i_n_/_w_h_o but not _/_u_s_r_/_b_i_n_/_X_1_1_/_x_t_e_r_m.

       WARNING: a pathname with wildcards will nnoott match a user
       command that consists of a relative path.  In other words,
       given the following _s_u_d_o_e_r_s entry:

           billy  workstation = /usr/bin/*

       user billy will be able to run any command in /usr/bin as
       root, such as _/_u_s_r_/_b_i_n_/_w.  The following two command will
       be allowed (the first assumes that _/_u_s_r_/_b_i_n is in the
       user's path):

           $ sudo w
           $ sudo /usr/bin/w

       However, this will not:

           $ cd /usr/bin
           $ sudo ./w

       For this reason you should only ggrraanntt access to commands
       using wildcards and never rreessttrriicctt access using them.
       This limitation will be removed in a future version of
       ssuuddoo.

       EExxcceeppttiioonnss ttoo wwiillddccaarrdd rruulleess

       The following exceptions apply to the above rules:

       ""      If the empty string "" is the only command line
               argument in the _s_u_d_o_e_r_s entry it means that com­
               mand is not allowed to be run with aannyy arguments.

       IInncclluuddiinngg ootthheerr ffiilleess ffrroomm wwiitthhiinn ssuuddooeerrss

       It is possible to include other _s_u_d_o_e_r_s files from within
       the _s_u_d_o_e_r_s file currently being parsed using the #include
       directive, similar to the one used by the C preprocessor.
       This is useful, for example, for keeping a site-wide _s_u_d_o_­
       _e_r_s file in addition to a per-machine local one.  For the
       sake of this example the site-wide _s_u_d_o_e_r_s will be
       _/_e_t_c_/_s_u_d_o_e_r_s and the per-machine one will be _/_e_t_c_/_s_u_d_o_­
       _e_r_s_._l_o_c_a_l.  To include _/_e_t_c_/_s_u_d_o_e_r_s_._l_o_c_a_l from _/_e_t_c_/_s_u_d_o_­
       _e_r_s we would use the following line in _/_e_t_c_/_s_u_d_o_e_r_s:

        #include /etc/sudoers.local




1.6.9                    October  4, 2004                      17





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


       When ssuuddoo reaches this line it will suspend processing of
       the current file (_/_e_t_c_/_s_u_d_o_e_r_s) and switch to _/_e_t_c_/_s_u_d_o_­
       _e_r_s_._l_o_c_a_l.  Upon reaching the end of _/_e_t_c_/_s_u_d_o_e_r_s_._l_o_c_a_l,
       the rest of _/_e_t_c_/_s_u_d_o_e_r_s will be processed.  Files that
       are included may themselves include other files.  A hard
       limit of 128 nested include files is enforced to prevent
       include file loops.

       OOtthheerr ssppeecciiaall cchhaarraacctteerrss aanndd rreesseerrvveedd wwoorrddss

       The pound sign ('#') is used to indicate a comment (unless
       it is part of a #include directive or unless it occurs in
       the context of a user name and is followed by one or more
       digits, in which case it is treated as a uid).  Both the
       comment character and any text after it, up to the end of
       the line, are ignored.

       The reserved word AALLLL is a built-in _a_l_i_a_s that always
       causes a match to succeed.  It can be used wherever one
       might otherwise use a Cmnd_Alias, User_Alias, Runas_Alias,
       or Host_Alias.  You should not try to define your own
       _a_l_i_a_s called AALLLL as the built-in alias will be used in
       preference to your own.  Please note that using AALLLL can be
       dangerous since in a command context, it allows the user
       to run aannyy command on the system.

       An exclamation point ('!') can be used as a logical _n_o_t
       operator both in an _a_l_i_a_s and in front of a Cmnd.  This
       allows one to exclude certain values.  Note, however, that
       using a ! in conjunction with the built-in ALL alias to
       allow a user to run "all but a few" commands rarely works
       as intended (see SECURITY NOTES below).

       Long lines can be continued with a backslash ('\') as the
       last character on the line.

       Whitespace between elements in a list as well as special
       syntactic characters in a _U_s_e_r _S_p_e_c_i_f_i_c_a_t_i_o_n ('=', ':',
       '(', ')') is optional.

       The following characters must be escaped with a backslash
       ('\') when used as part of a word (e.g. a username or
       hostname): '@', '!', '=', ':', ',', '(', ')', '\'.

FFIILLEESS
        /etc/sudoers           List of who can run what
        /etc/group             Local groups file
        /etc/netgroup          List of network groups

EEXXAAMMPPLLEESS
       Since the _s_u_d_o_e_r_s file is parsed in a single pass, order
       is important.  In general, you should structure _s_u_d_o_e_r_s
       such that the Host_Alias, User_Alias, and Cmnd_Alias spec­
       ifications come first, followed by any Default_Entry



1.6.9                    October  4, 2004                      18





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


       lines, and finally the Runas_Alias and user specifica­
       tions.  The basic rule of thumb is you cannot reference an
       Alias that has not already been defined.

       Below are example _s_u_d_o_e_r_s entries.  Admittedly, some of
       these are a bit contrived.  First, we define our _a_l_i_a_s_e_s:

        # User alias specification
        User_Alias     FULLTIMERS = millert, mikef, dowdy
        User_Alias     PARTTIMERS = bostley, jwfox, crawl
        User_Alias     WEBMASTERS = will, wendy, wim

        # Runas alias specification
        Runas_Alias    OP = root, operator
        Runas_Alias    DB = oracle, sybase

        # Host alias specification
        Host_Alias     SPARC = bigtime, eclipse, moet, anchor :\
                       SGI = grolsch, dandelion, black :\
                       ALPHA = widget, thalamus, foobar :\
                       HPPA = boa, nag, python
        Host_Alias     CUNETS = 128.138.0.0/255.255.0.0
        Host_Alias     CSNETS = 128.138.243.0, 128.138.204.0/24, 128.138.242.0
        Host_Alias     SERVERS = master, mail, www, ns
        Host_Alias     CDROM = orion, perseus, hercules

        # Cmnd alias specification
        Cmnd_Alias     DUMPS = /usr/bin/mt, /usr/sbin/dump, /usr/sbin/rdump,\
                               /usr/sbin/restore, /usr/sbin/rrestore
        Cmnd_Alias     KILL = /usr/bin/kill
        Cmnd_Alias     PRINTING = /usr/sbin/lpc, /usr/bin/lprm
        Cmnd_Alias     SHUTDOWN = /usr/sbin/shutdown
        Cmnd_Alias     HALT = /usr/sbin/halt
        Cmnd_Alias     REBOOT = /usr/sbin/reboot
        Cmnd_Alias     SHELLS = /usr/bin/sh, /usr/bin/csh, /usr/bin/ksh, \
                                /usr/local/bin/tcsh, /usr/bin/rsh, \
                                /usr/local/bin/zsh
        Cmnd_Alias     SU = /usr/bin/su

       Here we override some of the compiled in default values.
       We want ssuuddoo to log via _s_y_s_l_o_g(3) using the _a_u_t_h facility
       in all cases.  We don't want to subject the full time
       staff to the ssuuddoo lecture, user mmiilllleerrtt need not give a
       password, and we don't want to reset the LOGNAME or USER
       environment variables when running commands as root.
       Additionally, on the machines in the _S_E_R_V_E_R_S Host_Alias,
       we keep an additional local log file and make sure we log
       the year in each log line since the log entries will be
       kept around for several years.








1.6.9                    October  4, 2004                      19





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


        # Override built-in defaults
        Defaults               syslog=auth
        Defaults>root          !set_logname
        Defaults:FULLTIMERS    !lecture
        Defaults:millert       !authenticate
        Defaults@SERVERS       log_year, logfile=/var/log/sudo.log

       The _U_s_e_r _s_p_e_c_i_f_i_c_a_t_i_o_n is the part that actually deter­
       mines who may run what.

        root           ALL = (ALL) ALL
        %wheel         ALL = (ALL) ALL

       We let rroooott and any user in group wwhheeeell run any command on
       any host as any user.

        FULLTIMERS     ALL = NOPASSWD: ALL

       Full time sysadmins (mmiilllleerrtt, mmiikkeeff, and ddoowwddyy) may run
       any command on any host without authenticating themselves.

        PARTTIMERS     ALL = ALL

       Part time sysadmins (bboossttlleeyy, jjwwffooxx, and ccrraawwll) may run
       any command on any host but they must authenticate them­
       selves first (since the entry lacks the NOPASSWD tag).

        jack           CSNETS = ALL

       The user jjaacckk may run any command on the machines in the
       _C_S_N_E_T_S alias (the networks 128.138.243.0, 128.138.204.0,
       and 128.138.242.0).  Of those networks, only 128.138.204.0
       has an explicit netmask (in CIDR notation) indicating it
       is a class C network.  For the other networks in _C_S_N_E_T_S,
       the local machine's netmask will be used during matching.

        lisa           CUNETS = ALL

       The user lliissaa may run any command on any host in the
       _C_U_N_E_T_S alias (the class B network 128.138.0.0).

        operator       ALL = DUMPS, KILL, SHUTDOWN, HALT, REBOOT, PRINTING,\
                       sudoedit /etc/printcap, /usr/oper/bin/

       The ooppeerraattoorr user may run commands limited to simple main­
       tenance.  Here, those are commands related to backups,
       killing processes, the printing system, shutting down the
       system, and any commands in the directory _/_u_s_r_/_o_p_e_r_/_b_i_n_/.

        joe            ALL = /usr/bin/su operator

       The user jjooee may only _s_u(1) to operator.

        pete           HPPA = /usr/bin/passwd [A-z]*, !/usr/bin/passwd root



1.6.9                    October  4, 2004                      20





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


       The user ppeettee is allowed to change anyone's password
       except for root on the _H_P_P_A machines.  Note that this
       assumes _p_a_s_s_w_d(1) does not take multiple usernames on the
       command line.

        bob            SPARC = (OP) ALL : SGI = (OP) ALL

       The user bboobb may run anything on the _S_P_A_R_C and _S_G_I
       machines as any user listed in the _O_P Runas_Alias (rroooott
       and ooppeerraattoorr).

        jim            +biglab = ALL

       The user jjiimm may run any command on machines in the _b_i_g_l_a_b
       netgroup.  SSuuddoo knows that "biglab" is a netgroup due to
       the '+' prefix.

        +secretaries   ALL = PRINTING, /usr/bin/adduser, /usr/bin/rmuser

       Users in the sseeccrreettaarriieess netgroup need to help manage the
       printers as well as add and remove users, so they are
       allowed to run those commands on all machines.

        fred           ALL = (DB) NOPASSWD: ALL

       The user ffrreedd can run commands as any user in the _D_B
       Runas_Alias (oorraaccllee or ssyybbaassee) without giving a password.

        john           ALPHA = /usr/bin/su [!-]*, !/usr/bin/su *root*

       On the _A_L_P_H_A machines, user jjoohhnn may su to anyone except
       root but he is not allowed to give _s_u(1) any flags.

        jen            ALL, !SERVERS = ALL

       The user jjeenn may run any command on any machine except for
       those in the _S_E_R_V_E_R_S Host_Alias (master, mail, www and
       ns).

        jill           SERVERS = /usr/bin/, !SU, !SHELLS

       For any machine in the _S_E_R_V_E_R_S Host_Alias, jjiillll may run
       any commands in the directory /usr/bin/ except for those
       commands belonging to the _S_U and _S_H_E_L_L_S Cmnd_Aliases.

        steve          CSNETS = (operator) /usr/local/op_commands/

       The user sstteevvee may run any command in the directory
       /usr/local/op_commands/ but only as user operator.

        matt           valkyrie = KILL

       On his personal workstation, valkyrie, mmaatttt needs to be
       able to kill hung processes.



1.6.9                    October  4, 2004                      21





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


        WEBMASTERS     www = (www) ALL, (root) /usr/bin/su www

       On the host www, any user in the _W_E_B_M_A_S_T_E_R_S User_Alias
       (will, wendy, and wim), may run any command as user www
       (which owns the web pages) or simply _s_u(1) to www.

        ALL            CDROM = NOPASSWD: /sbin/umount /CDROM,\
                       /sbin/mount -o nosuid\,nodev /dev/cd0a /CDROM

       Any user may mount or unmount a CD-ROM on the machines in
       the CDROM Host_Alias (orion, perseus, hercules) without
       entering a password.  This is a bit tedious for users to
       type, so it is a prime candidate for encapsulating in a
       shell script.

SSEECCUURRIITTYY NNOOTTEESS
       It is generally not effective to "subtract" commands from
       ALL using the '!' operator.  A user can trivially circum­
       vent this by copying the desired command to a different
       name and then executing that.  For example:

           bill        ALL = ALL, !SU, !SHELLS

       Doesn't really prevent bbiillll from running the commands
       listed in _S_U or _S_H_E_L_L_S since he can simply copy those com­
       mands to a different name, or use a shell escape from an
       editor or other program.  Therefore, these kind of
       restrictions should be considered advisory at best (and
       reinforced by policy).

PPRREEVVEENNTTIINNGG SSHHEELLLL EESSCCAAPPEESS
       Once ssuuddoo executes a program, that program is free to do
       whatever it pleases, including run other programs.  This
       can be a security issue since it is not uncommon for a
       program to allow shell escapes, which lets a user bypass
       ssuuddoo's access control and logging.  Common programs that
       permit shell escapes include shells (obviously), editors,
       paginators, mail and terminal programs.

       There are three basic approaches to this problem:

       restrict  Avoid giving users access to commands that allow
                 the user to run arbitrary commands.  Many edi­
                 tors have a restricted mode where shell escapes
                 are disabled, though ssuuddooeeddiitt is a better solu­
                 tion to running editors via ssuuddoo.  Due to the
                 large number of programs that offer shell
                 escapes, restricting users to the set of pro­
                 grams that do not if often unworkable.

       noexec    Many systems that support shared libraries have
                 the ability to override default library func­
                 tions by pointing an environment variable (usu­
                 ally LD_PRELOAD) to an alternate shared library.



1.6.9                    October  4, 2004                      22





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


                 On such systems, ssuuddoo's _n_o_e_x_e_c functionality can
                 be used to prevent a program run by ssuuddoo from
                 executing any other programs.  Note, however,
                 that this applies only to native dynamically-
                 linked executables.  Statically-linked executa­
                 bles and foreign executables running under
                 binary emulation are not affected.

                 To tell whether or not ssuuddoo supports _n_o_e_x_e_c, you
                 can run the following as root:

                     sudo -V | grep "dummy exec"

                 If the resulting output contains a line that
                 begins with:

                     File containing dummy exec functions:

                 then ssuuddoo may be able to replace the exec family
                 of functions in the standard library with its
                 own that simply return an error.  Unfortunately,
                 there is no foolproof way to know whether or not
                 _n_o_e_x_e_c will work at compile-time.  _N_o_e_x_e_c should
                 work on SunOS, Solaris, *BSD, Linux, IRIX, Tru64
                 UNIX, MacOS X, and HP-UX 11.x.  It is known nnoott
                 to work on AIX and UnixWare.  _N_o_e_x_e_c is expected
                 to work on most operating systems that support
                 the LD_PRELOAD environment variable.  Check your
                 operating system's manual pages for the dynamic
                 linker (usually ld.so, ld.so.1, dyld, dld.sl,
                 rld, or loader) to see if LD_PRELOAD is sup­
                 ported.

                 To enable _n_o_e_x_e_c for a command, use the NOEXEC
                 tag as documented in the User Specification sec­
                 tion above.  Here is that example again:

                  aaron  shanty = NOEXEC: /usr/bin/more, /usr/bin/vi

                 This allows user aaaarroonn to run _/_u_s_r_/_b_i_n_/_m_o_r_e and
                 _/_u_s_r_/_b_i_n_/_v_i with _n_o_e_x_e_c enabled.  This will pre­
                 vent those two commands from executing other
                 commands (such as a shell).  If you are unsure
                 whether or not your system is capable of sup­
                 porting _n_o_e_x_e_c you can always just try it out
                 and see if it works.

       monitor   On operating systems that support the ssyyssttrraaccee
                 pseudo-device, the --with-systrace configure
                 option can be used to compile support for proc­
                 cess monitoring in ssuuddoo.  In monitor mode ssuuddoo
                 can transparently intercept a new command, allow
                 or deny it based on _s_u_d_o_e_r_s, and log the result.
                 This does require that ssuuddoo become a daemon that



1.6.9                    October  4, 2004                      23





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


                 persists until the command and all its descen­
                 dents have exited.

                 To enable monitor mode on a per-command basis,
                 use the MONITOR tag as documented in the User
                 Specification section above.  Here is that exam­
                 ple again:

                  chuck  research = MONITOR: ALL

                 This allows user cchhuucckk to run any command on the
                 machine research in monitor mode.  Any commands
                 run via shell escapes will be logged by ssuuddoo.

                 At the time of this writing the ssyyssttrraaccee pseudo-
                 device comes standard with OpenBSD and NetBSD
                 and is available as patches to FreeBSD, MacOS X
                 and Linux.  See <http://www.systrace.org/> for
                 more information.

       Note that restricting shell escapes is not a panacea.
       Programs running as root are still capable of many poten­
       tially hazardous operations (such as changing or overwrit­
       ing files) that could lead to unintended privilege escala­
       tion.  In the specific case of an editor, a safer approach
       is to give the user permission to run ssuuddooeeddiitt.

SSEEEE AALLSSOO
       _r_s_h(1), _s_u(1), _f_n_m_a_t_c_h(3), sudo(1m), visudo(1m)

CCAAVVEEAATTSS
       The _s_u_d_o_e_r_s file should aallwwaayyss be edited by the vviissuuddoo
       command which locks the file and does grammatical check­
       ing. It is imperative that _s_u_d_o_e_r_s be free of syntax
       errors since ssuuddoo will not run with a syntactically incor­
       rect _s_u_d_o_e_r_s file.

       When using netgroups of machines (as opposed to users), if
       you store fully qualified hostnames in the netgroup (as is
       usually the case), you either need to have the machine's
       hostname be fully qualified as returned by the hostname
       command or use the _f_q_d_n option in _s_u_d_o_e_r_s.

BBUUGGSS
       If you feel you have found a bug in ssuuddoo, please submit a
       bug report at http://www.sudo.ws/sudo/bugs/

SSUUPPPPOORRTT
       Commercial support is available for ssuuddoo, see
       http://www.sudo.ws/sudo/support.html for details.

       Limited free support is available via the sudo-users mail­
       ing list, see http://www.sudo.ws/mail­
       man/listinfo/sudo-users to subscribe or search the



1.6.9                    October  4, 2004                      24





SUDOERS(4)             MAINTENANCE COMMANDS            SUDOERS(4)


       archives.

DDIISSCCLLAAIIMMEERR
       SSuuddoo is provided ``AS IS'' and any express or implied war­
       ranties, including, but not limited to, the implied war­
       ranties of merchantability and fitness for a particular
       purpose are disclaimed.  See the LICENSE file distributed
       with ssuuddoo or http://www.sudo.ws/sudo/license.html for com­
       plete details.
















































1.6.9                    October  4, 2004                      25


